(this["webpackJsonpimg-repo"]=this["webpackJsonpimg-repo"]||[]).push([[0],{122:function(e,t,a){},123:function(e,t,a){"use strict";a.r(t);var n=a(3),r=a(0),c=a.n(r),i=a(15),s=a.n(i),o=a(171),l=a(41),u=a.n(l),j=a(59),d=a(14),b=a(91),m=a(42),h=(a(114),a(125),a(126),{apiKey:"AIzaSyATvkQz3GdQhlhw8b9bWjfOpy9PWZ2j_1k",authDomain:"img-repo-a5beb.firebaseapp.com",projectId:"img-repo-a5beb",storageBucket:"img-repo-a5beb.appspot.com",messagingSenderId:"328427547917",appId:"1:328427547917:web:2b4924a66de79e267f1444",measurementId:"G-LMCFPTQFQ5"});m.a.initializeApp(h);var p=m.a.auth(),O=m.a.firestore(),f=m.a.storage(),g=function(){var e=Object(j.a)(u.a.mark((function e(t,a,n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=17;break}return r=O.doc("users/".concat(t.uid)),e.next=4,r.get();case 4:if(e.sent.exists){e.next=14;break}return e.prev=6,e.next=9,r.set({email:a,displayName:n});case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(6),console.error("Error creating user document",e.t0);case 14:return e.abrupt("return",x(t.uid));case 17:console.error("No user provided");case 18:case"end":return e.stop()}}),e,null,[[6,11]])})));return function(t,a,n){return e.apply(this,arguments)}}(),x=function(){var e=Object(j.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=13;break}return e.prev=1,e.next=4,O.doc("users/".concat(t)).get();case 4:return a=e.sent,e.abrupt("return",Object(b.a)({uid:t},a.data()));case 8:e.prev=8,e.t0=e.catch(1),console.error("Error fetching user document",e.t0);case 11:e.next=14;break;case 13:console.error("No UID provided to fetch user");case 14:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),v=Object(r.createContext)({user:null}),y=function(e){var t=Object(r.useState)(null),a=Object(d.a)(t,2),c=a[0],i=a[1];return Object(r.useEffect)((function(){p.onAuthStateChanged(function(){var e=Object(j.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i(t?x(t):null);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(n.jsx)(v.Provider,{value:c,children:e.children})},w=a(54),S=a(17),N=a(69),C=a(155),k=a(163),I=a(93),P=a(157),T=a(164),E=a(165),W=a(161),D=a(174),B=a(173),U=a(51),A=a.n(U),F=a(87),L=a.n(F),R=a(159),q=a(177),M=a(178),G=a(172),Q=a(160),z=a(176),H=a(162),_=Object(C.a)((function(e){return{root:{height:"100vh"},paper:{margin:e.spacing(8,4),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}})),J=function(e){var t=e.entryType,a=Object(r.useState)(!1),c=Object(d.a)(a,2),i=c[0],s=c[1],o=Object(r.useState)(""),l=Object(d.a)(o,2),u=l[0],j=l[1],b=Object(r.useState)(""),h=Object(d.a)(b,2),O=h[0],f=h[1],g=Object(r.useState)(!1),x=Object(d.a)(g,2),v=x[0],y=x[1],w=Object(r.useState)(""),S=Object(d.a)(w,2),N=S[0],C=S[1],k=_(),T=function(){s(!i)};return Object(n.jsxs)(r.Fragment,{children:["button"===t?Object(n.jsx)(P.a,{color:"inherit",onClick:T,children:"Sign In"}):Object(n.jsx)(R.a,{onClick:T,href:"/#/sign-up",variant:"body2",children:"Already have an account? Sign in"}),Object(n.jsx)(q.a,{maxWidth:"xs",onClose:T,open:i,children:Object(n.jsxs)(B.a,{className:k.paper,children:[Object(n.jsx)(M.a,{className:k.avatar,children:Object(n.jsx)(A.a,{})}),Object(n.jsx)(I.a,{variant:"h5",gutterBottom:!0,children:"Sign in"}),Object(n.jsx)(I.a,{align:"center",variant:"caption",children:'Psst, if you want to test out the application, you can sign in with the email "johndoe@gmail.com" and the password "admin123"!'}),Object(n.jsxs)("form",{className:k.form,noValidate:!0,onSubmit:function(e){e.preventDefault();var t=v?m.a.auth.Auth.Persistence.LOCAL:m.a.auth.Auth.Persistence.SESSION;p.setPersistence(t).then((function(){return p.signInWithEmailAndPassword(u,O)})).catch((function(e){console.error(e),"auth/wrong-password"===e.code&&C("Incorrect password."),C("There was an error signing in.")}))},children:[Object(n.jsx)(G.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,onChange:function(e){j(e.target.value)}}),Object(n.jsx)(G.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:function(e){f(e.target.value)}}),Object(n.jsx)(Q.a,{control:Object(n.jsx)(z.a,{value:"remember",color:"primary"}),label:"Remember me",onChange:function(e){y(e.target.checked)}}),Object(n.jsx)(I.a,{color:"error",children:N}),Object(n.jsx)(P.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:k.submit,children:"Sign In"}),Object(n.jsxs)(H.a,{container:!0,children:[Object(n.jsx)(H.a,{item:!0,xs:!0,children:Object(n.jsx)(R.a,{href:"/#/reset-password",variant:"body2",children:"Forgot password?"})}),Object(n.jsx)(H.a,{item:!0,children:Object(n.jsx)(R.a,{href:"/#/sign-up",variant:"body2",children:"Don't have an account? Sign Up"})})]})]})]})})]})},Z=Object(C.a)((function(e){return{logo:{marginRight:e.spacing(2)},actionGroup:{marginLeft:"auto"},userName:{marginRight:e.spacing(2)}}})),K=function(){var e=Z(),t=Object(S.g)();return Object(n.jsxs)(c.a.Fragment,{children:[Object(n.jsx)(T.a,{position:"fixed",color:"primary",children:Object(n.jsxs)(E.a,{children:[Object(n.jsx)(W.a,{edge:"start",className:e.logo,color:"inherit","aria-label":"menu",children:Object(n.jsx)(A.a,{})}),Object(n.jsx)(I.a,{variant:"h6",children:"ImgRepo"}),Object(n.jsxs)(D.a,{variant:"fullWidth",value:t.pathname.length>1?t.pathname:"/home",children:[Object(n.jsx)(k.a,{label:"Home",value:"/home",component:w.b,to:"/home"}),function(){if(p.currentUser)return Object(n.jsx)(k.a,{label:" Your Images",value:"/images",component:w.b,to:"/images"})}()]}),Object(n.jsxs)(B.a,{className:e.actionGroup,children:[p.currentUser?Object(n.jsxs)(r.Fragment,{children:[Object(n.jsx)(I.a,{className:e.userName,variant:"body",display:"inline",children:p.currentUser.displayName}),Object(n.jsx)(P.a,{color:"inherit",onClick:function(){p.signOut()},children:"Sign Out"})]}):Object(n.jsx)(J,{color:"inherit",entryType:"button"}),Object(n.jsx)(W.a,{edge:"end",color:"inherit","aria-label":"menu",href:"https://github.com/yebrandon/img-repo",children:Object(n.jsx)(L.a,{})})]})]})}),Object(n.jsx)(E.a,{})]})},V=a(166),Y=a(167),X=a(168),$=a(88),ee=a.n($),te=Object(C.a)((function(){return{gridList:{width:"100%",height:"100%"},gridTile:{width:"25%",height:"25%"},gridTitleBar:{background:"linear-gradient(to bottom, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 70%, rgba(0,0,0,0) 100%)"},icon:{color:"white"},picture:{minWidth:"100%",minHeight:"100%",transform:"translate(-50%, -50%)",position:"relative",left:"50%",top:"50%"}}})),ae=function(e){var t=e.images,a=e.handleDelete,r=void 0===a?null:a,c=te();return Object(n.jsx)(V.a,{cellHeight:400,cols:4,className:c.gridList,children:t.sort((function(e,t){return function(e,t){var a=Date.parse(e.date),n=Date.parse(t.date);return a>n?-1:n>a?1:0}(e,t)})).map((function(e,t){return Object(n.jsxs)(Y.a,{className:te.gridTile,children:[Object(n.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",children:Object(n.jsx)("img",{src:e.url,alt:"",className:c.picture})}),Object(n.jsx)(X.a,{className:c.gridTitleBar,title:e.name.slice(0,e.name.indexOf("|")),subtitle:"".concat(e.uploadedBy," - ").concat(new Date(e.date).toDateString()),titlePosition:"top",actionIcon:r?Object(n.jsx)(W.a,{onClick:function(){r(e.name)},className:c.icon,children:Object(n.jsx)(ee.a,{})}):null})]},t)}))})},ne=function(){var e=Object(r.useState)([]),t=Object(d.a)(e,2),a=t[0],i=t[1];return Object(r.useEffect)((function(){var e=f.ref("images/public");i([]),e.list({maxResults:100}).then((function(e){e.items.forEach((function(e){!function(e){e.getDownloadURL().then((function(t){e.getMetadata().then((function(a){i((function(n){return[{url:t,uploadedBy:a.customMetadata.uploadedBy,name:e.name,date:a.timeCreated}].concat(Object(N.a)(n))}))}))}))}(e)}))}))}),[]),Object(n.jsxs)(c.a.Fragment,{children:[Object(n.jsx)(K,{}),Object(n.jsx)(ae,{images:a})]})},re=a(169),ce=Object(C.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)}}})),ie=function(){var e=Object(r.useState)(""),t=Object(d.a)(e,2),a=t[0],c=t[1],i=Object(r.useState)(""),s=Object(d.a)(i,2),o=s[0],l=s[1],u=Object(r.useState)(""),j=Object(d.a)(u,2),b=j[0],m=j[1],h=Object(r.useState)(""),f=Object(d.a)(h,2),x=f[0],v=f[1],y=Object(r.useState)(null),w=Object(d.a)(y,2),S=w[0],N=w[1],C=ce();return Object(n.jsxs)(re.a,{className:C.paper,component:"main",maxWidth:"xs",children:[Object(n.jsx)(M.a,{className:C.avatar,children:Object(n.jsx)(A.a,{})}),Object(n.jsx)(I.a,{component:"h1",variant:"h5",children:"Sign up"}),Object(n.jsxs)("form",{className:C.form,onSubmit:function(e){(e.preventDefault(),b===x)?O.collection("users").where("displayName","==",a).get().then((function(e){0===e.docs.length?(p.createUserWithEmailAndPassword(o,b).then((function(e){return e.user.updateProfile({displayName:a}).then(g(e.user,o,a))})).catch((function(e){console.error(e),N("Error creating account.")})),c(""),l(""),m(""),v("")):N("Username is already taken!")})).catch((function(e){console.error(e),N("Error getting user document.")})):N("Passwords do not match.")},children:[Object(n.jsxs)(H.a,{container:!0,spacing:1,children:[Object(n.jsx)(H.a,{item:!0,xs:12,children:Object(n.jsx)(G.a,{value:a,variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"displayName",label:"Username",name:"displayName",autoComplete:"displayName",autoFocus:!0,onChange:function(e){c(e.target.value.replace(/[^A-Z0-9]/gi,""))}})}),Object(n.jsx)(H.a,{item:!0,xs:12,children:Object(n.jsx)(G.a,{value:o,variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",onChange:function(e){l(e.target.value)}})}),Object(n.jsx)(H.a,{item:!0,xs:12,children:Object(n.jsx)(G.a,{value:b,variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"passwordOne",label:"Password",type:"password",id:"passwordOne",autoComplete:"current-password",onChange:function(e){m(e.target.value.trim())}})}),Object(n.jsx)(H.a,{item:!0,xs:12,children:Object(n.jsx)(G.a,{value:x,variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"passwordTwo",label:"Confirm Password",type:"password",id:"passwordTwo",autoComplete:"current-password",onChange:function(e){v(e.target.value.trim())}})}),Object(n.jsx)(I.a,{color:"error",children:S})]}),Object(n.jsx)(P.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:C.submit,children:"Sign Up"})]}),Object(n.jsx)(H.a,{container:!0,justify:"flex-end",children:Object(n.jsx)(H.a,{item:!0,children:Object(n.jsx)(J,{buttonType:"link"})})})]})},se=a(89),oe=a.n(se),le=Object(C.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(3)},submit:{margin:e.spacing(3,0,2)}}})),ue=function(){var e=Object(r.useState)(""),t=Object(d.a)(e,2),a=t[0],c=t[1],i=Object(r.useState)(null),s=Object(d.a)(i,2),o=s[0],l=s[1],u=Object(r.useState)(!1),j=Object(d.a)(u,2),b=j[0],m=j[1],h=le();return Object(n.jsxs)(re.a,{className:h.paper,component:"main",maxWidth:"xs",children:[Object(n.jsx)(M.a,{className:h.avatar,children:Object(n.jsx)(oe.a,{})}),Object(n.jsx)(I.a,{component:"h1",variant:"h5",children:"Reset Password"}),Object(n.jsxs)("form",{className:h.form,onSubmit:function(e){e.preventDefault(),p.sendPasswordResetEmail(a).then((function(){m(!0)})).catch((function(e){console.error(e),l("Error sending passwording reset link")}))},children:[Object(n.jsxs)(H.a,{container:!0,spacing:2,children:[Object(n.jsx)(H.a,{item:!0,xs:12,children:Object(n.jsx)(G.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0,onChange:function(e){c(e.target.value)}})}),b?Object(n.jsx)(I.a,{color:"primary",children:"Link sent!"}):o?Object(n.jsx)(I.a,{color:"error",children:o}):void 0]}),Object(n.jsx)(P.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:h.submit,children:"Send Reset Link"}),Object(n.jsx)(H.a,{container:!0,justify:"flex-end",children:Object(n.jsx)(H.a,{item:!0,children:Object(n.jsx)(R.a,{href:"#/sign-in",variant:"body2",children:"Back to Sign In"})})})]})]})},je=a(128),de=a(170),be=a(90),me=a.n(be),he=Object(C.a)((function(e){return{toolBar:{flexDirection:"row",display:"flex",alignItems:"center"},uploadGroup:{alignItems:"center",marginLeft:"auto"},selectionText:{marginRight:e.spacing(2)}}})),pe=function(){var e=Object(r.useState)([]),t=Object(d.a)(e,2),a=t[0],c=t[1],i=Object(r.useState)("public"),s=Object(d.a)(i,2),o=s[0],l=s[1],u=Object(r.useState)([]),j=Object(d.a)(u,2),b=j[0],m=j[1],h=Object(r.useState)(""),O=Object(d.a)(h,2),g=O[0],x=O[1],v=Object(r.useState)(!1),y=Object(d.a)(v,2),w=y[0],S=y[1],C=he(),T=f.ref("private"===o?"images/private/".concat(p.currentUser.displayName):"images/public"),E=function(e){e.getDownloadURL().then((function(t){e.getMetadata().then((function(a){(function(e){return"public"===o&&e.customMetadata.uploadedBy===p.currentUser.displayName||"public"!==o})(a)&&c((function(n){return[{url:t,uploadedBy:a.customMetadata.uploadedBy,name:e.name,date:a.timeCreated}].concat(Object(N.a)(n))}))}))}))};Object(r.useEffect)((function(){c([]),x(""),T.list({maxResults:100}).then((function(e){e.items.forEach((function(e){E(e)}))}))}),[o]);return Object(n.jsxs)("div",{children:[Object(n.jsx)(K,{}),Object(n.jsxs)(je.a,{square:!0,className:C.toolBar,children:[Object(n.jsxs)(D.a,{value:o,indicatorColor:"secondary",textColor:"secondary",onChange:function(e,t){l(t)},variant:"fullWidth",children:[Object(n.jsx)(k.a,{value:"public",label:"Public"}),Object(n.jsx)(k.a,{value:"private",label:"Private"})]}),Object(n.jsx)(I.a,{color:"error",children:g}),Object(n.jsxs)(B.a,{className:C.uploadGroup,children:[function(){var e;return 1===b.length?e=b[0].name:b.length>0&&(e="Selected ".concat(b.length," files")),Object(n.jsx)(I.a,{className:C.selectionText,display:"inline",children:e})}(),Object(n.jsxs)(P.a,{variant:"contained",component:"label",children:["Select upload(s)",Object(n.jsx)("input",{type:"file",accept:"image/*",hidden:!0,onChange:function(e){x(""),m(Array.from(e.target.files))},multiple:!0})]}),Object(n.jsx)(P.a,{startIcon:Object(n.jsx)(me.a,{}),variant:"contained",component:"label",onClick:function(){S(!0);var e=b.map((function(e){return new Promise((function(t){var n="".concat(e.name,"|").concat(p.currentUser.displayName);if(a.map((function(e){return e.name})).includes(n))x("".concat(e.name," already exists!")),S(!1);else{var r={customMetadata:{uploadedBy:p.currentUser.displayName}},c=T.child(n);c.put(e,r).on("state_changed",(function(){}),(function(){x("Error uploading files")}),(function(){E(c),t("success")}))}}))}));Promise.all(e).then((function(){m([]),S(!1)}))},disabled:b.length<1,children:"Upload"})]})]}),Object(n.jsx)(de.a,{variant:w?"indeterminate":"determinate",className:C.progressBar,value:0}),Object(n.jsx)(ae,{images:a,handleDelete:function(e){x(""),T.child(e).delete().then((function(){c(a.filter((function(t){return t.name!==e})))})).catch((function(e){console.error(e),x("Error deleting image")}))}})]})},Oe=function(){return Object(r.useContext)(v)?Object(n.jsx)(w.a,{basename:"/",children:Object(n.jsxs)(S.d,{children:[Object(n.jsx)(S.b,{exact:!0,path:"/",render:function(){return Object(n.jsx)(ne,{})}}),Object(n.jsx)(S.b,{path:"/home",render:function(){return Object(n.jsx)(ne,{})}}),Object(n.jsx)(S.b,{path:"/images",render:function(){return Object(n.jsx)(pe,{})}}),Object(n.jsx)(S.b,{path:"/",render:function(){return Object(n.jsx)(S.a,{to:"/home"})}})]})}):Object(n.jsx)(w.a,{basename:"/",children:Object(n.jsxs)(S.d,{children:[Object(n.jsx)(S.b,{exact:!0,path:"/",render:function(){return Object(n.jsx)(ne,{})}}),Object(n.jsx)(S.b,{path:"/home",render:function(){return Object(n.jsx)(ne,{})}}),Object(n.jsx)(S.b,{path:"/sign-up",render:function(){return Object(n.jsx)(ie,{})}}),Object(n.jsx)(S.b,{path:"/reset-password",render:function(){return Object(n.jsx)(ue,{})}}),Object(n.jsx)(S.b,{path:"/",render:function(){return Object(n.jsx)(S.a,{to:"/home"})}})]})})},fe=(a(122),function(){return Object(n.jsxs)(y,{children:[Object(n.jsx)(o.a,{}),Object(n.jsx)(Oe,{})]})}),ge=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,181)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;a(e),n(e),r(e),c(e),i(e)}))};s.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(fe,{})}),document.getElementById("root")),ge()}},[[123,1,2]]]);
//# sourceMappingURL=main.d2ddfe56.chunk.js.map